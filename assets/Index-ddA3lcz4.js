import{r as U,u as I,s as w}from"./user-DnsQ2kUu.js";import{g as D,s as E}from"./url-params-CKo46eKI.js";import{d as $}from"./dayjs-DWuKVjmt.js";import{e as v,f as A,h as N,L as R,g as z,j as M,l as P,m as Y}from"./index-CFNcU0YK.js";import{_ as j}from"./Password.vue_vue_type_script_setup_true_lang-5zdlRA3j.js";import{j as q,k as f,m as H}from"./element-plus-A1T5m3oM.js";import{af as t,d as B,r as b,m as L,q as S,ag as _,aq as V,c as J,o as K,R as h,u as c,J as T,K as F}from"./@vue-BpwAlabI.js";import"./qs-BNjWm72D.js";import"./call-bind-apply-helpers-zm886y3p.js";import"./function-bind-CHqF18-c.js";import"./es-errors-CFxpeikN.js";import"./side-channel-CKpA4dfz.js";import"./object-inspect-CiOUnV34.js";import"./side-channel-list-IZ6ufBWj.js";import"./side-channel-map-BvuNa93F.js";import"./get-intrinsic-DYXGad5I.js";import"./es-object-atoms-Ditt1eQ6.js";import"./math-intrinsics-Cv-yPkyD.js";import"./gopd-fcd2-aIC.js";import"./es-define-property-bDCdrV83.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-CQl1k7Za.js";import"./dunder-proto-tAQ_MH3o.js";import"./hasown-DwiY0sux.js";import"./call-bound-DTEBmFVe.js";import"./side-channel-weakmap-CmoVxQN_.js";import"./pinia-BW-Ptvox.js";import"./msw-Ve9Ip08e.js";import"./@open-draft-BbAaxlxc.js";import"./is-node-process-BZ-2HBMI.js";import"./outvariant-BBS2yBlX.js";import"./strict-event-emitter-CrFXw_VT.js";import"./@mswjs--W5AcoDd.js";import"./@bundled-es-modules-DDnD6D9h.js";import"./path-to-regexp-wCvGX3Wm.js";import"./headers-polyfill-C4bzlTWf.js";import"./vue-i18n-CJu5jhK-.js";import"./@intlify-qjRvhfuG.js";import"./vue-router-Czm1P09_.js";import"./axios-t--hEgTQ.js";import"./@vueuse-DlNcspcR.js";import"./color-Cwf1wIF_.js";import"./color-string-CKWVXYG4.js";import"./color-name-BQ5IbGbl.js";import"./simple-swizzle-Tvclth0e.js";import"./color-convert-CkRI355n.js";import"./vue-cropper-mJCAEvi3.js";import"./@element-plus-CrghIkfH.js";import"./sortablejs-C83syoBY.js";import"./nprogress-fpr8O7K9.js";import"./lodash-es-S0Y0Up6J.js";import"./@popperjs-D_chPuIy.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-9PlIezaS.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@floating-ui-DwceP2Gb.js";var i=(s=>(s.Create="create_administrator_user",s.Update="update_administrator_user",s.Remove="remove_administrator_user",s.Password="password_administrator_user",s))(i||{});const G=(s,p)=>{const n=v([i.Update]),l=v([i.Remove]),m=v([i.Password]),o=[{prop:"expand",label:"用户详情",type:"expand",headerComponent:()=>[t("span")],defaultComponent:({row:e})=>[t("div",{class:"px-2"},t(q,{border:!0,direction:"vertical"},()=>[t(f,{rowspan:2,align:"center"},()=>t(H,{src:e.avatar,size:"large",icon:"Avatar",shape:"square",style:"--el-avatar-icon-size: 40px"})),t(f,{label:"联系方式",width:"50%"},()=>e.phone),t(f,{label:"邮箱地址",width:"50%"},()=>e.email),t(f,{label:"备注信息"},()=>e.remark)]))]},{prop:"id",label:"用户编号",defaultHide:!0},{prop:"username",label:"登录账号",alwaysShow:!0},{prop:"nickname",label:"用户昵称"},{prop:"role",label:"所属角色",defaultComponent:({row:e})=>{var a;return[t("div",(a=e.role)==null?void 0:a.name)]}},{prop:"createAt",label:"创建时间"},{prop:"status",label:"用户状态",headerComponent:({column:e})=>[t(Y,{column:e,status:p.value.status,onChange(a){p.value.pageNo=1,p.value.status=a,s.execute(p.value)}})],defaultComponent:({row:e})=>{const a=I(e.id);return[t(P,{service:a,status:e.status,permission:[i.Update],onRefresh:s.refresh})]}}],d=[n,l,m].filter(e=>e);return d.length&&o.push({prop:"$",label:"管理操作",width:Math.max(120,d.length*80),defaultComponent:({row:e})=>[t(M,()=>{const a=[];if(n&&a.push(t(A,{href:`#/administrator/user/update?id=${e.id}`})),l){const r=U(e.id);a.push(t(N,{service:r,onRefresh:s.refresh}))}return m&&a.push(t(R,{onClick:()=>{const r=z(t(j,{row:e,onClose:()=>r.close()}),{title:"修改密码"})}},()=>"修改密码")),a})]}),{columns:o,schemas:[{tag:"ElInput",formItemProps:{prop:"username",label:"登录账号"}},{tag:"ElInput",formItemProps:{prop:"nickname",label:"用户昵称"}},{extra:!0,tag:"ElInput",formItemProps:{prop:"phone",label:"联系方式"}},{extra:!0,tag:"ElInput",formItemProps:{prop:"email",label:"邮箱地址"}}]}},Xe=B({__name:"Index",setup(s){const p=()=>({pageNo:1,pageSize:10}),n=()=>({...p(),...D([{key:"pageNo",type:"Number"},{key:"pageSize",type:"Number"},{key:"username"},{key:"nickname"},{key:"phone"},{key:"email"},{key:"status",type:"Array<number>"}])}),l=b(n()),m=w(),o=b(n()),d=L(()=>{var a;return(((a=m.result.value)==null?void 0:a.data)??[]).map(r=>(r.createAt=$(r.createAt).format("YYYY-MM-DD HH:mm:ss"),r))}),{columns:g,schemas:e}=G(m,o);return S(o,()=>E(o.value),{deep:!0}),m.execute(o.value),(a,r)=>{const k=_("common-search"),y=_("widget-create"),C=_("common-table"),x=V("acl");return K(),J("div",null,[h(k,{model:l.value,"onUpdate:model":r[0]||(r[0]=u=>l.value=u),params:o.value,"onUpdate:params":r[1]||(r[1]=u=>o.value=u),service:c(m),"init-value":p,schemas:c(e)},null,8,["model","params","service","schemas"]),h(C,{params:o.value,"onUpdate:params":r[2]||(r[2]=u=>o.value=u),data:d.value,columns:c(g),service:c(m)},{"toolbar-right":T(()=>[F(h(y,{tag:"a",href:"#/administrator/user/create"},null,512),[[x,[c(i).Create]]])]),_:1},8,["params","data","columns","service"])])}}});export{Xe as default};
