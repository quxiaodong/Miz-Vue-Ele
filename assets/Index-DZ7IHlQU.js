import{r as x,u as I,s as R}from"./button-BG3rqky_.js";import{d as $}from"./dayjs-DWuKVjmt.js";import{P as v,_ as U}from"./Create.vue_vue_type_script_setup_true_lang-CQth31WJ.js";import{s as k}from"./menu-BG4fEp25.js";import{e as b,f as B,g as M,h as w,j as y,k as A,l as E,m as Y}from"./index-CFNcU0YK.js";import{_ as D}from"./Update.vue_vue_type_script_setup_true_lang-vS-vGi5z.js";import{af as s,r as h,m as C,d as H,ag as g,c as N,o as T,R as _,u as l,J as j}from"./@vue-BpwAlabI.js";import"./call-bind-apply-helpers-zm886y3p.js";import"./function-bind-CHqF18-c.js";import"./es-errors-CFxpeikN.js";import"./Form.vue_vue_type_script_setup_true_lang-BiYhovmq.js";import"./pinia-BW-Ptvox.js";import"./msw-Ve9Ip08e.js";import"./@open-draft-BbAaxlxc.js";import"./is-node-process-BZ-2HBMI.js";import"./outvariant-BBS2yBlX.js";import"./strict-event-emitter-CrFXw_VT.js";import"./@mswjs--W5AcoDd.js";import"./@bundled-es-modules-DDnD6D9h.js";import"./path-to-regexp-wCvGX3Wm.js";import"./headers-polyfill-C4bzlTWf.js";import"./qs-BNjWm72D.js";import"./side-channel-CKpA4dfz.js";import"./object-inspect-CiOUnV34.js";import"./side-channel-list-IZ6ufBWj.js";import"./side-channel-map-BvuNa93F.js";import"./get-intrinsic-DYXGad5I.js";import"./es-object-atoms-Ditt1eQ6.js";import"./math-intrinsics-Cv-yPkyD.js";import"./gopd-fcd2-aIC.js";import"./es-define-property-bDCdrV83.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-CQl1k7Za.js";import"./dunder-proto-tAQ_MH3o.js";import"./hasown-DwiY0sux.js";import"./call-bound-DTEBmFVe.js";import"./side-channel-weakmap-CmoVxQN_.js";import"./vue-i18n-CJu5jhK-.js";import"./@intlify-qjRvhfuG.js";import"./vue-router-Czm1P09_.js";import"./axios-t--hEgTQ.js";import"./element-plus-A1T5m3oM.js";import"./lodash-es-S0Y0Up6J.js";import"./@element-plus-CrghIkfH.js";import"./@popperjs-D_chPuIy.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-9PlIezaS.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@floating-ui-DwceP2Gb.js";import"./@vueuse-DlNcspcR.js";import"./color-Cwf1wIF_.js";import"./color-string-CKWVXYG4.js";import"./color-name-BQ5IbGbl.js";import"./simple-swizzle-Tvclth0e.js";import"./color-convert-CkRI355n.js";import"./vue-cropper-mJCAEvi3.js";import"./sortablejs-C83syoBY.js";import"./nprogress-fpr8O7K9.js";const P=(p,o)=>{const n=b([v.Update]),r=b([v.Remove]),a=[{prop:"id",label:"按钮编号",defaultHide:!0},{prop:"name",label:"按钮名称",alwaysShow:!0},{prop:"code",label:"按钮代码"},{prop:"menu",label:"所属菜单",defaultComponent:({row:e})=>[s("div",e.menu.path)]},{prop:"createAt",label:"创建时间"},{prop:"status",label:"按钮状态",headerComponent:({column:e})=>[s(Y,{column:e,status:o.value.status,onChange(t){o.value.pageNo=1,o.value.status=t,p.execute(o.value)}})],defaultComponent:({row:e})=>{const t=I(e.id);return[s(E,{service:t,status:e.status,permission:[v.Update],onRefresh:p.refresh})]}}],u=[n,r].filter(e=>e);u.length&&a.push({prop:"$",label:"管理操作",width:Math.max(120,u.length*80),defaultComponent:({row:e})=>[s(y,()=>{const t=[];if(n&&t.push(s(B,{onClick:()=>{const m=M(s(D,{row:e,onRefresh:()=>{m.close(),p.refresh()}}),{type:"update"})}})),r){const m=x(e.id);t.push(s(w,{service:m,onRefresh:p.refresh}))}return t})]});const c=h([]);k().execute({}).then(({data:e})=>c.value=e);const d=C(()=>[{tag:"ElInput",formItemProps:{prop:"name",label:"按钮名称"}},{tag:"ElInput",formItemProps:{prop:"code",label:"按钮代码"}},{tag:"ElTreeSelect",tagProps:{class:"!w-[178px] sm:!w-full",value:o.value.menuId,data:A(c.value.map(({id:e,name:t,parentId:m,sort:f})=>({id:e,parentId:m,sort:f,value:e,label:t}))),checkStrictly:!0,filterable:!0,clearable:!0,onClear:()=>o.value.menuId=void 0},formItemProps:{prop:"menuId",label:"所属菜单"}}]);return{columns:a,schemas:d}},Fe=H({__name:"Index",setup(p){const o=()=>({pageNo:1,pageSize:10}),n=h(o()),r=R(),a=h(o()),u=C(()=>{var e;return(((e=r.result.value)==null?void 0:e.data)??[]).map(t=>(t.createAt=$(t.createAt).format("YYYY-MM-DD HH:mm:ss"),t))}),{columns:c,schemas:d}=P(r,a);return r.execute(a.value),(e,t)=>{const m=g("common-search"),f=g("common-table");return T(),N("div",null,[_(m,{model:n.value,"onUpdate:model":t[0]||(t[0]=i=>n.value=i),params:a.value,"onUpdate:params":t[1]||(t[1]=i=>a.value=i),service:l(r),"init-value":o,schemas:l(d)},null,8,["model","params","service","schemas"]),_(f,{params:a.value,"onUpdate:params":t[2]||(t[2]=i=>a.value=i),data:u.value,columns:l(c),service:l(r)},{"toolbar-right":j(()=>[_(U,{onRefresh:l(r).refresh},null,8,["onRefresh"])]),_:1},8,["params","data","columns","service"])])}}});export{Fe as default};
