import{s as R}from"./role-CjUwidL2.js";import{q as C,g as E,v as V}from"./index-CFNcU0YK.js";import{n as y}from"./navigate-Dfi05TM4.js";import{d as B,aA as u,ay as q,aB as M,m as i,ag as t,I as S,o as U,J as m,a as d,R as r,u as j,r as z}from"./@vue-BpwAlabI.js";const A={class:"mx-auto max-w-3xl"},L={class:"text-right"},J=B({__name:"Form",props:u({loading:{type:Boolean},formRules:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:u(["submit"],["update:modelValue"]),setup(c,{emit:f}){const v=f,l=q("dom"),o=M(c,"modelValue"),n=i(()=>Object.assign({email:C()},c.formRules)),g=()=>{const e=z([]);R().execute({}).then(({data:s})=>e.value=s);const a=[{slot:"avatar"},{colProps:{span:12,xs:24},tag:"ElInput",formItemProps:{prop:"username",label:"登录账号"}},{colProps:{span:12,xs:24},tag:"ElInput",formItemProps:{prop:"nickname",label:"用户昵称"}}];return n.value.password1&&a.push({colProps:{span:12,xs:24},tag:"ElInput",tagProps:{showPassword:!0},formItemProps:{prop:"password1",label:"登录密码"}}),n.value.password2&&a.push({colProps:{span:12,xs:24},tag:"ElInput",tagProps:{showPassword:!0},formItemProps:{prop:"password2",label:"确认密码"}}),a.push({colProps:{span:12,xs:24},tag:"ElInput",formItemProps:{prop:"phone",label:"联系方式"}},{colProps:{span:12,xs:24},tag:"ElInput",formItemProps:{prop:"email",label:"邮箱地址"}},{colProps:{span:12,xs:24},tag:"ElSelect",tagProps:{clearable:!0,onClear:()=>o.value.roleId=null},formItemProps:{prop:"roleId",label:"所属角色"},options:i(()=>e.value.map(({id:s,name:p})=>({value:s,label:p})))},{colProps:{span:12,xs:24},tag:"ElSelect",formItemProps:{prop:"status",label:"用户状态"}},{tag:"ElInput",tagProps:{type:"textarea"},formItemProps:{prop:"remark",label:"备注信息"}}),{schemas:a}},{schemas:_}=g(),P=()=>{const e=E(r(V,{src:o.value.avatar,onCrop:a=>{o.value.avatar=URL.createObjectURL(a),e.close()}},null))},b=()=>y.back({link:"/administrator/user"}),h=()=>{var e;(e=l.value)!=null&&e.formRef&&l.value.formRef.validate().then(()=>v("submit"))};return(e,a)=>{const s=t("el-avatar"),p=t("widget-cancel"),I=t("widget-submit"),x=t("common-form"),w=t("el-card");return U(),S(w,{shadow:"never",class:"!border-0"},{default:m(()=>[d("div",A,[r(x,{ref_key:"dom",ref:l,modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=k=>o.value=k),rules:n.value,schemas:j(_)},{avatar:m(()=>[r(s,{size:100,icon:"Avatar",shape:"square",src:o.value.avatar,style:{"--el-avatar-icon-size":"80px"},class:"mx-auto cursor-pointer",onClick:P},null,8,["src"])]),default:m(()=>[d("div",L,[r(p,{onClick:b}),r(I,{loading:e.loading,onClick:h},null,8,["loading"])])]),_:1},8,["modelValue","rules","schemas"])])]),_:1})}}});export{J as _};
