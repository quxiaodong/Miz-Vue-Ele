import{r as R,u as U,s as $}from"./role-CjUwidL2.js";import{g as E,s as I}from"./url-params-CKo46eKI.js";import{d as N}from"./dayjs-DWuKVjmt.js";import{e as b,f as A,h as D,j as H,k as M,l as T,m as V}from"./index-CFNcU0YK.js";import{c as Y,g,h as y}from"./element-plus-A1T5m3oM.js";import{af as o,d as z,r as C,m as j,q,ag as v,aq as B,c as K,o as S,R as _,u as d,J,K as F}from"./@vue-BpwAlabI.js";import"./qs-BNjWm72D.js";import"./call-bind-apply-helpers-zm886y3p.js";import"./function-bind-CHqF18-c.js";import"./es-errors-CFxpeikN.js";import"./side-channel-CKpA4dfz.js";import"./object-inspect-CiOUnV34.js";import"./side-channel-list-IZ6ufBWj.js";import"./side-channel-map-BvuNa93F.js";import"./get-intrinsic-DYXGad5I.js";import"./es-object-atoms-Ditt1eQ6.js";import"./math-intrinsics-Cv-yPkyD.js";import"./gopd-fcd2-aIC.js";import"./es-define-property-bDCdrV83.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-CQl1k7Za.js";import"./dunder-proto-tAQ_MH3o.js";import"./hasown-DwiY0sux.js";import"./call-bound-DTEBmFVe.js";import"./side-channel-weakmap-CmoVxQN_.js";import"./pinia-BW-Ptvox.js";import"./msw-Ve9Ip08e.js";import"./@open-draft-BbAaxlxc.js";import"./is-node-process-BZ-2HBMI.js";import"./outvariant-BBS2yBlX.js";import"./strict-event-emitter-CrFXw_VT.js";import"./@mswjs--W5AcoDd.js";import"./@bundled-es-modules-DDnD6D9h.js";import"./path-to-regexp-wCvGX3Wm.js";import"./headers-polyfill-C4bzlTWf.js";import"./vue-i18n-CJu5jhK-.js";import"./@intlify-qjRvhfuG.js";import"./vue-router-Czm1P09_.js";import"./axios-t--hEgTQ.js";import"./@vueuse-DlNcspcR.js";import"./color-Cwf1wIF_.js";import"./color-string-CKWVXYG4.js";import"./color-name-BQ5IbGbl.js";import"./simple-swizzle-Tvclth0e.js";import"./color-convert-CkRI355n.js";import"./vue-cropper-mJCAEvi3.js";import"./@element-plus-CrghIkfH.js";import"./sortablejs-C83syoBY.js";import"./nprogress-fpr8O7K9.js";import"./lodash-es-S0Y0Up6J.js";import"./@popperjs-D_chPuIy.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-9PlIezaS.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@floating-ui-DwceP2Gb.js";var f=(s=>(s.Create="create_administrator_role",s.Update="update_administrator_role",s.Remove="remove_administrator_role",s))(f||{});const G=(s,p)=>{const n=b([f.Update]),l=b([f.Remove]),m=[{prop:"expand",label:"角色详情",type:"expand",headerComponent:()=>[o("span")],defaultComponent:({row:t})=>{const r=t.menus.filter(e=>!e.acls).map(e=>({...e,buttons:t.buttons.filter(u=>u.menuId===e.id)})),i=M(r);return[o("div",{class:"px-2"},o(Y,{data:i,rowKey:"id",size:"small",border:!0,showHeader:!1,maxHeight:500},()=>[o(g,e=>[o(y,{modelValue:!0,disabled:!0,label:e.row.name})]),o(g,e=>e.row.buttons.map(u=>[o(y,{modelValue:!0,disabled:!0,label:u.name})]))]))]}},{prop:"id",label:"角色编号",defaultHide:!0},{prop:"name",label:"角色名称",alwaysShow:!0},{prop:"code",label:"角色代码"},{prop:"createAt",label:"创建时间"},{prop:"status",label:"角色状态",headerComponent:({column:t})=>[o(V,{column:t,status:p.value.status,onChange(r){p.value.pageNo=1,p.value.status=r,s.execute(p.value)}})],defaultComponent:({row:t})=>{const r=U(t.id);return[o(T,{service:r,status:t.status,permission:[f.Update],onRefresh:s.refresh})]}}],a=[n,l].filter(t=>t);return a.length&&m.push({prop:"$",label:"管理操作",width:Math.max(120,a.length*80),defaultComponent:({row:t})=>[o(H,()=>{const r=[];if(n&&r.push(o(A,{href:`#/administrator/role/update?id=${t.id}`})),l){const i=R(t.id);r.push(o(D,{service:i,onRefresh:s.refresh}))}return r})]}),{columns:m,schemas:[{tag:"ElInput",formItemProps:{prop:"name",label:"角色名称"}},{tag:"ElInput",formItemProps:{prop:"code",label:"角色代码"}}]}},Pe=z({__name:"Index",setup(s){const p=()=>({pageNo:1,pageSize:10}),n=()=>({...p(),...E([{key:"pageNo",type:"Number"},{key:"pageSize",type:"Number"},{key:"name"},{key:"code"},{key:"status",type:"Array<number>"}])}),l=C(n()),m=$(),a=C(n()),h=j(()=>{var i;return(((i=m.result.value)==null?void 0:i.data)??[]).map(e=>(e.createAt=N(e.createAt).format("YYYY-MM-DD HH:mm:ss"),e))}),{columns:t,schemas:r}=G(m,a);return q(a,()=>I(a.value),{deep:!0}),m.execute(a.value),(i,e)=>{const u=v("common-search"),x=v("widget-create"),k=v("common-table"),w=B("acl");return S(),K("div",null,[_(u,{model:l.value,"onUpdate:model":e[0]||(e[0]=c=>l.value=c),params:a.value,"onUpdate:params":e[1]||(e[1]=c=>a.value=c),service:d(m),"init-value":p,schemas:d(r)},null,8,["model","params","service","schemas"]),_(k,{params:a.value,"onUpdate:params":e[2]||(e[2]=c=>a.value=c),data:h.value,columns:d(t),service:d(m)},{"toolbar-right":J(()=>[F(_(x,{tag:"a",href:"#/administrator/role/create"},null,512),[[w,[d(f).Create]]])]),_:1},8,["params","data","columns","service"])])}}});export{Pe as default};
